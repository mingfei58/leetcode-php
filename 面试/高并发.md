## 书籍推荐

- 分布式系统架构落地与瓶颈突破

## 问题

### 1.RPC调用经历的过程

1. 底层的网络通信协议处理
2. 解决寻址问题
3. 请求/响应参数的序列化与反序列化工作

### 2.常见的限流算法

1. 令牌桶算法
2. 漏桶算法
3. 计数器算法

### 3.秒杀、抢购下商品库存扣减优化方案

> 高并发商品抢购下，为了防止商品超卖，需要解决以下几个问题
>
> - 数据的一致性问题
> - 如何突破串行化锁机制下的性能瓶颈
> - 避免死锁

1. 客户端发送库存扣减请求
2. 获取锁（悲观锁或乐观锁），并添加超时处理机制
3. 扣减实时库存，成功后写入消息队列，后续由消费者扣减真实库存
4. 释放锁

### 4.高并发下的商品读写方案

> 高并发数据写入集群中时，需要确保在多写过程中数据的一致性，避免因为某个节点故障导致出现脏读的情况，其次向集群中添加、删除节点时，要保证缓存key的有效性
>
> 监听节点的写入情况，一旦在某个节点写入失败（经过重试后同样失败），所有配置监听的客户端感知变化并同步更新



### 5.分表中的多维度落盘如何实现

>实施分库分表时，数据最初以什么样的维度进行落盘，最后只能通过这样的维度进行查询。订单需要查询的数据往往同时包含买家和卖家两类群体，在处理订单数据，到底以哪个群体进行基准呢

解决办法是对同一份订单数据进行冗余存储，需要同时维护两份数据表

冗余表的实现包含同步写入和异步写入两种形式。同步写入的实现较为简单，即将之前的单写变为双写，但是写入时间成倍增长；异步写入通过异步模型将数据进行同步

无论同步写入或者异步写入，都存在数据不一致的情况出现，在分布式系统下，采用的方案是确保分布式事务的最终一致性，一致性的实现方案如下：

1. 客户端发起下单请求
2. 首先以买家维度存储订单，然后将买家订单信息写入一致性检测消息队列中
3. 异步写入卖家订单表，然后将卖家订单信息写入一致性检测消息队列中
4. 异步进行一致性消息检测

